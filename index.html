<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Project B - Catering & Monitoring</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  * {margin:0; padding:0; box-sizing:border-box;}
  body {font-family: Arial, sans-serif; background:#fafafa; color:#333;}
  nav {
    background:#d35400; padding:15px 30px; display:flex; justify-content:space-between; align-items:center;
    color:#fff; position:sticky; top:0; z-index:1000;
  }
  nav .logo {font-size:20px; font-weight:bold;}
  nav ul {list-style:none; display:flex; gap:20px;}
  nav ul li {cursor:pointer;}
  nav .right {display:flex; align-items:center; gap:15px;}
  nav button {background:#fff; color:#d35400; border:none; padding:7px 15px; border-radius:5px; cursor:pointer; font-weight:bold;}
  .hero {background:url('https://images.unsplash.com/photo-1600891964599-f61ba0e24092?w=1600') center/cover no-repeat; height:300px; display:flex; align-items:center; justify-content:center; color:white; font-size:32px; font-weight:bold; text-shadow:2px 2px 4px rgba(0,0,0,0.6);}
  .produk {padding:40px 60px;}
  .produk h2 {text-align:center; margin-bottom:20px; color:#d35400;}
  .kategori-tabs {display:flex; justify-content:center; gap:15px; margin-bottom:20px; flex-wrap:wrap;}
  .kategori-tabs button {padding:10px 15px; border:none; border-radius:5px; background:#d35400; color:#fff; cursor:pointer; font-weight:bold;}
  .produk-grid {display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:20px;}
  .card {background:#fff; border-radius:10px; overflow:hidden; box-shadow:0 4px 10px rgba(0,0,0,0.1); transition:transform 0.2s;}
  .card:hover {transform:scale(1.03);}
  .card img {width:100%; height:180px; object-fit:cover;}
  .card-body {padding:15px;}
  .card-body h3 {margin-bottom:10px;}
  .price {color:#27ae60; font-weight:bold;}
  .rating {color:#f39c12; margin:5px 0;}
  .komentar {font-size:14px; margin-top:5px; background:#f9f9f9; padding:5px; border-radius:5px;}
  .modal {position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.6); display:none; justify-content:center; align-items:center;}
  .modal-content {background:#fff; padding:30px; border-radius:10px; width:300px; text-align:center; position:relative;}
  .modal-content h2 {margin-bottom:20px; color:#d35400;}
  .modal-content input, .modal-content select, .modal-content textarea {width:100%; padding:10px; margin:8px 0; border:1px solid #ccc; border-radius:5px;}
  .modal-content button {width:100%; background:#d35400; color:#fff; padding:10px; border:none; border-radius:5px; font-weight:bold; margin-top:10px;}
  .close-btn {position:absolute; top:10px; right:10px; cursor:pointer; font-weight:bold; font-size:18px;}
  #dashboard {display:none; padding:30px;}
  #dashboard h2 {color:#d35400; margin-bottom:20px;}
  .tabs {display:flex; gap:15px; margin-bottom:20px; flex-wrap:wrap;}
  .tabs button {padding:10px 15px; border:none; border-radius:5px; background:#d35400; color:#fff; cursor:pointer;}
  .tab-content {display:none;}
  .tab-content.active {display:block;}
  .form-produk input, .form-produk select, .form-produk textarea {padding:10px; margin:5px 0; width:100%; border:1px solid #ccc; border-radius:5px;}
  .form-produk button {margin-top:10px; padding:10px; width:100%; background:#27ae60; color:white; border:none; border-radius:5px; font-weight:bold;}
</style>
</head>
<body>

<nav>
  <div class="logo">üç¥ Project B Catering</div>
  <ul>
    <li onclick="scrollToSection('produk')">Produk</li>
    <li onclick="scrollToSection('about')">Tentang</li>
    <li onclick="scrollToSection('saran')">Saran</li>
    <li onclick="scrollToSection('grafik')">Grafik</li>
  </ul>
  <div class="right">
    <span id="user-info"></span>
    <button id="loginBtn">Login</button>
    <button id="logoutBtn" style="display:none;">Logout</button>
  </div>
</nav>

<div class="hero">Lezat, Sehat, dan Praktis</div>

<section class="produk" id="produk">
  <h2>Produk Catering Kami</h2>
  <div class="kategori-tabs" id="kategoriTabs"></div>
  <div class="produk-grid" id="produkGrid"></div>
</section>

<section id="about" style="padding:40px; text-align:center; background:#f4f4f4;">
  <h2>Tentang Kami</h2>
  <p>Project B Catering hadir untuk memberikan solusi makanan sehat, lezat, dan praktis untuk acara Anda.</p>
</section>

<section id="saran" style="padding:40px; text-align:center;">
  <h2>Kirim Saran & Feedback</h2>
  <div class="form-produk" style="max-width:400px;margin:auto;">
    <input type="text" id="namaVisitor" placeholder="Nama Anda">
    <textarea id="saranVisitor" placeholder="Tulis saran atau feedback Anda..."></textarea>
    <button onclick="tambahSaran()">Kirim Saran</button>
    <button onclick="exportSaranCSV()">Export Saran CSV</button>
  </div>
  <div id="listSaran" style="margin-top:20px;"></div>
</section>

<section id="grafik" style="padding:40px; text-align:center;">
  <h2>Grafik Monitoring Produk & Rating</h2>
  <canvas id="chartProduk" style="max-width:800px;margin:auto;"></canvas>
  <button onclick="exportProdukCSV()" style="margin-top:10px;padding:10px 20px;background:#d35400;color:#fff;border:none;border-radius:5px;cursor:pointer;">Export Produk CSV</button>
</section>

<div class="modal" id="loginModal">
  <div class="modal-content">
    <span class="close-btn" onclick="closeModal()">&times;</span>
    <h2>Login Admin</h2>
    <input type="text" id="username" placeholder="Username">
    <input type="password" id="password" placeholder="Password">
    <button onclick="login()">Login</button>
  </div>
</div>

<section id="dashboard">
  <h2>Dashboard Admin</h2>
  <div class="tabs">
    <button onclick="openTab('kategoriAdmin')">Kelola Kategori</button>
    <button onclick="openTab('produkAdmin')">Kelola Produk</button>
    <button onclick="openTab('monitoring')">Monitoring</button>
  </div>

  <div id="kategoriAdmin" class="tab-content active">
    <h3>Tambah Kategori Baru</h3>
    <div class="form-produk">
      <input type="text" id="namaKategori" placeholder="Nama Kategori Baru">
      <button onclick="tambahKategori()">Tambah Kategori</button>
    </div>
  </div>

  <div id="produkAdmin" class="tab-content">
    <h3>Tambah Produk Baru</h3>
    <div class="form-produk">
      <input type="text" id="namaProduk" placeholder="Nama Produk">
      <input type="number" id="hargaProduk" placeholder="Harga Produk">
      <input type="text" id="fotoProduk" placeholder="Link Foto Produk">
      <select id="kategoriProduk"></select>
      <button onclick="tambahProduk()">Tambah Produk</button>
    </div>
  </div>

  <div id="monitoring" class="tab-content">
    <h3>Monitoring Data</h3>
    <p>Grafik & data monitoring dapat dilihat di tab Grafik di atas.</p>
  </div>
</section>

<script>
let kategoriList = JSON.parse(localStorage.getItem("kategoriList")) || ["Prasmanan","Nasi Box","Snack","Minuman"];
let produkDefault = [
  {nama:"Nasi Kotak Ayam", harga:25000, foto:"https://images.unsplash.com/photo-1606788075761-9a60cf6a3d58?w=800", kategori:"Nasi Box", rating:[], komentar:[]},
  {nama:"Snack Box", harga:15000, foto:"https://images.unsplash.com/photo-1551218808-94e220e084d2?w=800", kategori:"Snack", rating:[], komentar:[]},
  {nama:"Buffet Prasmanan", harga:50000, foto:"https://images.unsplash.com/photo-1525755662778-989d0524087e?w=800", kategori:"Prasmanan", rating:[], komentar:[]}
];
let produkList = JSON.parse(localStorage.getItem("produkList")) || produkDefault;
let saranList = JSON.parse(localStorage.getItem("saranList")) || [];

const produkGrid = document.getElementById("produkGrid");
const kategoriTabs = document.getElementById("kategoriTabs");
const dropdownKategori = document.getElementById("kategoriProduk");
const listSaranDiv = document.getElementById("listSaran");

// ====== Render Produk ======
function renderProduk(list){
  produkGrid.innerHTML="";
  list.forEach((p,index)=>{
    const card = document.createElement("div");
    card.classList.add("card");
    card.setAttribute("data-kategori", p.kategori);
    let avgRating = 0;
    if(p.rating.length>0) avgRating = p.rating.reduce((a,b)=>a+b,0)/p.rating.length;
    card.innerHTML=`
      <img src="${p.foto}" alt="${p.nama}">
      <div class="card-body">
        <h3>${p.nama}</h3>
        <p class="price">Rp ${parseInt(p.harga).toLocaleString("id-ID")}</p>
        <p><small>Kategori: ${p.kategori}</small></p>
        <p class="rating">Rating: ${avgRating.toFixed(1)} ‚òÖ</p>
        <div>
          <label>Berikan Rating:</label>
          <select onchange="beriRating(${index}, this.value)">
            <option value="">-</option>
            <option value="1">1 ‚òÖ</option>
            <option value="2">2 ‚òÖ</option>
            <option value="3">3 ‚òÖ</option>
            <option value="4">4 ‚òÖ</option>
            <option value="5">5 ‚òÖ</option>
          </select>
        </div>
        <div style="margin-top:5px;">
          <input type="text" placeholder="Tulis komentar..." id="komentar${index}">
          <button onclick="tambahKomentar(${index})">Kirim</button>
        </div>
        <div id="listKomentar${index}">${p.komentar.map(c=>`<div class="komentar">${c}</div>`).join("")}</div>
      </div>
    `;
    produkGrid.appendChild(card);
  });
  renderChart();
}

// ====== Filter Produk ======
function updateKategoriTabs(){
  kategoriTabs.innerHTML="";
  const allBtn = document.createElement("button");
  allBtn.textContent="Semua Produk";
  allBtn.onclick=()=>filterProduk("all");
  kategoriTabs.appendChild(allBtn);
  kategoriList.forEach(kat=>{
    const btn=document.createElement("button");
    btn.textContent=kat;
    btn.onclick=()=>filterProduk(kat);
    kategoriTabs.appendChild(btn);
  });
}
function filterProduk(kat){
  const cards=document.querySelectorAll(".card");
  cards.forEach(c=>{
    if(kat==="all"||c.getAttribute("data-kategori")===kat) c.style.display="block";
    else c.style.display="none";
  });
}

// ====== Tambah Produk & Kategori ======
function updateKategoriDropdown(){
  dropdownKategori.innerHTML="";
  kategoriList.forEach(kat=>{
    const option=document.createElement("option");
    option.value=kat; option.textContent=kat;
    dropdownKategori.appendChild(option);
  });
}

function tambahProduk(){
  const nama=document.getElementById("namaProduk").value.trim();
  const harga=document.getElementById("hargaProduk").value.trim();
  const foto=document.getElementById("fotoProduk").value.trim();
  const kategori=document.getElementById("kategoriProduk").value;
  if(nama && harga && foto){
    produkList.push({nama,harga,foto,kategori,rating:[],komentar:[]});
    localStorage.setItem("produkList",JSON.stringify(produkList));
    renderProduk(produkList);
    document.getElementById("namaProduk").value="";
    document.getElementById("
